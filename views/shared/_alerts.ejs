<!-- views/shared/_alerts.ejs -->
<% if (typeof error !=='undefined' && error.length> 0) { %>
    <script type="application/json" id="error-flash">
        <%- JSON.stringify(error) %>
    </script>
<% } %>

<% if (typeof success !=='undefined' && success.length> 0) { %>
    <script type="application/json" id="success-flash">
    <%- JSON.stringify(success) %>
    </script>
<% } %>

<script>
    // Wait for DOM to be ready before showing alerts
    document.addEventListener('DOMContentLoaded', function () {
        const showFlash = (id, type) => {
            const el = document.getElementById(id);
            if (!el) return;
            const data = JSON.parse(el.textContent);
            if (Array.isArray(data)) {
                data.forEach(msg => {
                    if (typeof window.CustomNotification !== 'undefined') {
                        new window.CustomNotification(msg, type);
                    }
                });
            } else {
                if (typeof window.CustomNotification !== 'undefined') {
                    new window.CustomNotification(data, type);
                }
            }
        };
        showFlash('error-flash', 'danger');
        showFlash('success-flash', 'success');
    });
</script>